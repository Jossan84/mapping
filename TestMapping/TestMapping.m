%TestMapping%10/11/2021close all;clear;clc;if exist('OCTAVE_VERSION', 'builtin') ~= 0% OCTAVE    pkg load mapping;else% MATLABend% Add pathsaddpath('functions');addpath('data');% Load dataload('gpsData.mat');% Reshape data[n m] = size(gpsData.latitude);lat = gpsData.latitude * pi/180; lon = gpsData.longitude * pi/180;%%h =  gpsData.altitude;h = zeros([n m]);lat0 = lat(1);lon0 = lon(1);h0 = 0;lla = [lat lon h];lla0 = [ones([n m]).*lat0 ones([n m]).*lon0 ones([n m]).*h0];%% TESTsellipsoid = 'wgs_84';% Method 0% Introduced in R2021a[x0,y0,z0] = lla2enu(ellipsoid, lat, lon, h, lat0, lon0, h0); % Method 1wgs84 = wgs84Ellipsoid;[x1,y1,z1] = geodetic2enu(lat*180/pi,lon*180/pi,h,lat0*180/pi,lon0*180/pi,h0,wgs84);% Method 2[x2,y2,z2] = geodetic2Enu(ellipsoid, lat, lon, h, lat0, lon0, h0);% Method 3[~, x3, y3] = haversin_distance(lat0,lat,lon0,lon,6.3781e6);% Method 4[x4, y4] = latlontoxy(lat0*180/pi ,lon0*180/pi, lat*180/pi, lon*180/pi);%% Plotsfigure(1);title('GPS Coordinates');hold on;grid on;plot(lon * 180/pi, lat * 180/pi, '.');plot(lon0 * 180/pi, lat0 * 180/pi, '*');text(lon0 * 180/pi, lat0 * 180/pi, 'Init');xlabel('lon [deg]');ylabel('lat [deg]');figure(2);title('ENU Coordinates');hold on;plot(x0, y0, '.-');plot(x1, y1, '.-');plot(x2, y2, '.-');plot(x3, y3, '.-');plot(x4, y4, '.-');grid on;axis equal;xlabel('x [m]');ylabel('y [m]');legend('lla2enu','geodetic2enu', 'geodetic2Enu', 'Haversine', 'latlontoxy');figure(3);title('X deviation');hold on;plot(x0./x0, '.-');plot(x0./x1, '.-');plot(x0./x2, '.-');plot(x0./y3, '.-');plot(x0./x4, '.-');grid on;xlabel('Nº samples');ylabel('Ref X Deviation []');legend('lla2enu','geodetic2enu', 'geodetic2Enu', 'Haversine', 'latlontoxy');figure(4);title('Y Deviation');hold on;plot(y0./y0, '.-');plot(y0./y1, '.-');plot(y0./y2, '.-');plot(y0./y3, '.-');plot(y0./y4, '.-');grid on;xlabel('Nº samples');ylabel('Ref Y Deviation []');legend('lla2enu','geodetic2enu', 'geodetic2Enu', 'Haversine', 'latlontoxy');figure(5);title('X Error^2');hold on;plot((x0-x0).^2, '.-');plot((x0-x1).^2, '.-');plot((x0-x2).^2, '.-');plot((x0-y3).^2, '.-');plot((x0-x4).^2, '.-');grid on;xlabel('Nº samples');ylabel('x error^2 []');legend('lla2enu','geodetic2enu', 'geodetic2Enu', 'Haversine', 'latlontoxy');figure(6);title('Y Error^2');hold on;plot((y0-y0).^2, '.-');plot((y0-y1).^2, '.-');plot((y0-y2).^2, '.-');plot((y0-y3).^2, '.-');plot((y0-y4).^2, '.-');grid on;xlabel('Nº samples');ylabel('y error^2 []');legend('lla2enu','geodetic2enu', 'geodetic2Enu', 'Haversine', 'latlontoxy');figure(7);title('X Means');hold on;grid on;xMean0 = mean(x0);xStd0 = std(x0);plot(xMean0*ones(size(x0)), linspace(0,1,length(x0)), '-');xMean1 = mean(x1);xStd1 = std(x1);plot(xMean1*ones(size(x1)), linspace(0,1,length(x1)), '-');xMean2 = mean(x2);xStd2 = std(x2);plot(xMean2*ones(size(x2)), linspace(0,1,length(x2)), '-');xMean3 = mean(x3);xStd3 = std(x3);plot(xMean3*ones(size(x3)), linspace(0,1,length(x3)), '-');xMean4 = mean(x4);xStd4 = std(x4);plot(xMean4*ones(size(x4)), linspace(0,1,length(x4)), '-');xlabel('x Means');ylabel('[]');legend('lla2enu','geodetic2enu', 'geodetic2Enu', 'Haversine', 'latlontoxy');hold off;figure(8);title('Y Means');hold on;grid on;yMean0 = mean(y0);yStd0 = std(y0);plot(yMean0*ones(size(y0)), linspace(0,1,length(y0)), '-');yMean1 = mean(y1);yStd1 = std(y1);plot(yMean1*ones(size(y1)), linspace(0,1,length(y1)), '-');yMean2 = mean(y2);yStd2 = std(y2);plot(yMean2*ones(size(y2)), linspace(0,1,length(y2)), '-');yMean3 = mean(y3);yStd3 = std(y3);plot(yMean3*ones(size(y3)), linspace(0,1,length(y3)), '-');yMean4 = mean(y4);yStd4 = std(y4);plot(yMean4*ones(size(y4)), linspace(0,1,length(y4)), '-');xlabel('y Means');ylabel('[]');legend('lla2enu','geodetic2enu', 'geodetic2Enu', 'Haversine', 'latlontoxy');hold off;rmpath('functions');rmpath('data');