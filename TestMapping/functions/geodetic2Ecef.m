function [X,Y,Z] = geodetic2Ecef(ellipsoid, lat, lon, h)% geodetic2Ecef% 10/11/2021% Transform geodetic coordinates to geocentric Earth-centered Earth-fixed%% Usage:%     [X,Y,Z] = geodetic2Ecef(ellipsoid, lat, lon, h)%     arguments:%         ellipsoid     Reference spheroid, only wgs84 and grs80 are implemented%         lat      	    Geodetic latitude [rad]%         lon           Geodetic longitude [rad]%         h             Ellipsoidal height [m]%% Examples:%     [X,Y,Z] = geodetic2Ecef('wgs_84', lat, lon, h)%     [X,Y,Z] = geodetic2Ecef('grs_80', lat, lon, h)%% Dependencies:%       switch ellipsoid  case 'wgs_84'    a = 6378137.0; % Semi-major axis    b = 6356752.31424518; % Semi-minor axis  case 'grs_80'    a = 6378137.0;    b = 6356752.314140;   otherwise    error('Ellipsoid system is not implemented');end% Oblate ellipsoide = sqrt((a^2-b^2)/(a^2));%% Vectorial methodN = (a./sqrt(1-e^2 * sin(lat).^2));X = (N + h) .* cos(lat) .* cos(lon);Y = (N + h) .* cos(lat) .* sin(lon);Z = ((b^2/a^2) * N + h) .* sin(lat);%% Iterative method% for i = 1 : length(lat) %     N = (a/sqrt(1 - ((e^2) * sin(lat(i))^2)));%     X(i,1) = (h(i) + N) * cos(lat(i)) * cos(lon(i));%     Y(i,1) = (h(i) + N) * cos(lat(i)) * sin(lon(i));    %     Z(i,1) = ((((b^2)/(a^2)) * N) + h(i)) * sin(lat(i));% end  end